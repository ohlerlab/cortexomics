---
title: "Report_cluto_clusts"
author: "Dermot Harnett"
date: "26/03/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE)
library(tidyverse)
library(magrittr)
library(data.table)
library(stringr)
library(magrittr)
library(splines)

load('~/projects/cortexomics/data/cluto_clusts.Rdata')
```

##Clusters - CLUTO, Transformed Expr Data

```{r Cluster trajectory plot,fig.width=12,fig.height=8,cache=T}
make_cluster_trajplots(clutoclustlist_filt[[13]]$cluster)
```

## GO term enrichment per cluster

```{r Go Enirched GO terms,results='asis'}

go_enrichmenttables <- list(
  goenrichmentsbp,
  goenrichmentsmf,
  goenrichmentscc
)

for(onttable in go_enrichmenttables[1]){
  for(cluster in names(onttable[1:2])){
    cat(str_interp('\n### Cluster: ${cluster}'))
   # DT::datatable(onttable[[cluster]])
    knitr::kable(onttable[[cluster]])
   # cat(knitr::knit_child(text = knitr::knit_expand('knitr::kable(onttable[[cluster]])'),envir = globalenv(),quiet=T))
  }
}
```

##Clusters - Relationships by GO shared terms

```{r Go Enrichment Cladograms}
for(on in c('BP','CC','MF')){

godistmatrix%>%
  dist('manhattan')%>%
  hclust%>%
  as.dendrogram%>%
  plot( cex = 0.2, horiz=TRUE, main = paste0('\nCLUTO clusters, distance by enriched GO terms :\n ',ont))

}
```
